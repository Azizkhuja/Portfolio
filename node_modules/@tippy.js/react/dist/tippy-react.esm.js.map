{"version":3,"file":"tippy-react.esm.js","sources":["../src/utils.js","../src/util-hooks.js","../src/Tippy.js","../src/TippySingleton.js","../src/hooks.js"],"sourcesContent":["export const isBrowser =\n  typeof window !== 'undefined' && typeof document !== 'undefined';\n\nexport function preserveRef(ref, node) {\n  if (ref) {\n    if (typeof ref === 'function') {\n      ref(node);\n    }\n    if ({}.hasOwnProperty.call(ref, 'current')) {\n      ref.current = node;\n    }\n  }\n}\n\nexport function ssrSafeCreateDiv() {\n  return isBrowser && document.createElement('div');\n}\n\nexport function updateClassName(tooltip, action, classNames) {\n  classNames.split(/\\s+/).forEach(name => {\n    if (name) {\n      tooltip.classList[action](name);\n    }\n  });\n}\n","import {isBrowser, updateClassName} from './utils';\nimport {useLayoutEffect, useEffect, useRef} from 'react';\nimport {createSingleton} from 'tippy.js';\n\nexport const useIsomorphicLayoutEffect = isBrowser\n  ? useLayoutEffect\n  : useEffect;\n\nexport function useUpdateClassName(component, className, deps) {\n  useIsomorphicLayoutEffect(() => {\n    const {tooltip} = component.instance.popperChildren;\n    if (className) {\n      updateClassName(tooltip, 'add', className);\n      return () => {\n        updateClassName(tooltip, 'remove', className);\n      };\n    }\n  }, [className, ...deps]);\n}\n\nexport function useInstance(initialValue) {\n  // Using refs instead of state as it's recommended to not store imperative\n  // values in state due to memory problems in React(?)\n  const ref = useRef();\n\n  if (!ref.current) {\n    ref.current =\n      typeof initialValue === 'function' ? initialValue() : initialValue;\n  }\n\n  return ref.current;\n}\n\nexport function useSingletonCreate(component, props, enabled, deps) {\n  useIsomorphicLayoutEffect(() => {\n    const {instances} = component;\n    const instance = createSingleton(instances, props);\n\n    component.instance = instance;\n\n    if (!enabled) {\n      instance.disable();\n    }\n\n    return () => {\n      instance.destroy();\n      component.instances = instances.filter(i => !i.state.isDestroyed);\n    };\n  }, deps);\n}\n\nexport function useSingletonUpdate(component, props, enabled) {\n  useIsomorphicLayoutEffect(() => {\n    if (component.renders === 1) {\n      component.renders++;\n      return;\n    }\n\n    const {instance} = component;\n\n    instance.setProps(props);\n\n    if (enabled) {\n      instance.enable();\n    } else {\n      instance.disable();\n    }\n  });\n}\n","import React, {forwardRef, cloneElement, useState} from 'react';\nimport PropTypes from 'prop-types';\nimport {createPortal} from 'react-dom';\nimport tippy from 'tippy.js';\nimport {preserveRef, ssrSafeCreateDiv} from './utils';\nimport {\n  useInstance,\n  useIsomorphicLayoutEffect,\n  useUpdateClassName,\n} from './util-hooks';\n\nexport function Tippy({\n  children,\n  content,\n  className,\n  visible,\n  singleton,\n  enabled = true,\n  multiple = true,\n  ignoreAttributes = true,\n  // Filter React development reserved props\n  // added by babel-preset-react dev plugins:\n  // transform-react-jsx-self and transform-react-jsx-source\n  __source,\n  __self,\n  ...restOfNativeProps\n}) {\n  const isControlledMode = visible !== undefined;\n  const isSingletonMode = singleton !== undefined;\n\n  const [mounted, setMounted] = useState(false);\n  const component = useInstance(() => ({\n    container: ssrSafeCreateDiv(),\n    renders: 1,\n  }));\n\n  const props = {\n    ignoreAttributes,\n    multiple,\n    ...restOfNativeProps,\n    content: component.container,\n  };\n\n  if (isControlledMode) {\n    props.trigger = 'manual';\n  }\n\n  if (isSingletonMode) {\n    enabled = false;\n  }\n\n  const deps = [children.type];\n\n  // CREATE\n  useIsomorphicLayoutEffect(() => {\n    const instance = tippy(component.ref, props);\n\n    component.instance = instance;\n\n    if (!enabled) {\n      instance.disable();\n    }\n\n    if (visible) {\n      instance.show();\n    }\n\n    if (isSingletonMode) {\n      singleton(instance);\n    }\n\n    setMounted(true);\n\n    return () => {\n      instance.destroy();\n    };\n  }, deps);\n\n  // UPDATE\n  useIsomorphicLayoutEffect(() => {\n    // Prevent this effect from running on 1st render\n    if (component.renders === 1) {\n      component.renders++;\n      return;\n    }\n\n    const {instance} = component;\n\n    instance.setProps(props);\n\n    if (enabled) {\n      instance.enable();\n    } else {\n      instance.disable();\n    }\n\n    if (isControlledMode) {\n      if (visible) {\n        instance.show();\n      } else {\n        instance.hide();\n      }\n    }\n  });\n\n  useUpdateClassName(component, className, deps);\n\n  return (\n    <>\n      {cloneElement(children, {\n        ref(node) {\n          component.ref = node;\n          preserveRef(children.ref, node);\n        },\n      })}\n      {mounted && createPortal(content, component.container)}\n    </>\n  );\n}\n\nif (process.env.NODE_ENV !== 'production') {\n  const ContentType = PropTypes.oneOfType([\n    PropTypes.number,\n    PropTypes.string,\n    PropTypes.element,\n  ]);\n\n  Tippy.propTypes = {\n    content: PropTypes.oneOfType([ContentType, PropTypes.arrayOf(ContentType)])\n      .isRequired,\n    children: PropTypes.element.isRequired,\n    visible: PropTypes.bool,\n    enabled: PropTypes.bool,\n    className: PropTypes.string,\n    singleton: PropTypes.func,\n  };\n}\n\nexport default forwardRef(function TippyWrapper({children, ...props}, ref) {\n  return (\n    <Tippy {...props}>\n      {cloneElement(children, {\n        ref(node) {\n          preserveRef(ref, node);\n          preserveRef(children.ref, node);\n        },\n      })}\n    </Tippy>\n  );\n});\n","import {Children, cloneElement} from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  useInstance,\n  useUpdateClassName,\n  useSingletonUpdate,\n  useSingletonCreate,\n} from './util-hooks';\n\nexport default function TippySingleton({\n  children,\n  className,\n  enabled = true,\n  ignoreAttributes = true,\n  ...restOfNativeProps\n}) {\n  const component = useInstance({\n    instances: [],\n    renders: 1,\n  });\n\n  const props = {\n    ignoreAttributes,\n    ...restOfNativeProps,\n  };\n\n  const deps = [children.length];\n\n  useSingletonCreate(component, props, enabled, deps);\n  useSingletonUpdate(component, props, enabled);\n  useUpdateClassName(component, className, deps);\n\n  return Children.map(children, child => {\n    return cloneElement(child, {\n      enabled: false,\n      onCreate(instance) {\n        if (child.props.onCreate) {\n          child.props.onCreate(instance);\n        }\n\n        component.instances.push(instance);\n      },\n    });\n  });\n}\n\nif (process.env.NODE_ENV !== 'production') {\n  TippySingleton.propTypes = {\n    children: PropTypes.arrayOf(PropTypes.element).isRequired,\n  };\n}\n","import {\n  useInstance,\n  useSingletonCreate,\n  useSingletonUpdate,\n  useUpdateClassName,\n} from './util-hooks';\n\nexport function useSingleton({\n  className,\n  enabled = true,\n  ignoreAttributes = true,\n  ...restOfNativeProps\n} = {}) {\n  const component = useInstance({\n    instance: null,\n    instances: [],\n    renders: 1,\n  });\n\n  const props = {\n    ignoreAttributes,\n    ...restOfNativeProps,\n  };\n\n  const deps = [component.instances.length];\n\n  useSingletonCreate(component, props, enabled, deps);\n  useSingletonUpdate(component, props, enabled);\n  useUpdateClassName(component, className, deps);\n\n  return instance => {\n    component.instances.push(instance);\n  };\n}\n"],"names":["isBrowser","window","document","preserveRef","ref","node","hasOwnProperty","call","current","ssrSafeCreateDiv","createElement","updateClassName","tooltip","action","classNames","split","forEach","name","classList","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","useUpdateClassName","component","className","deps","instance","popperChildren","useInstance","initialValue","useRef","useSingletonCreate","props","enabled","instances","createSingleton","disable","destroy","filter","i","state","isDestroyed","useSingletonUpdate","renders","setProps","enable","Tippy","children","content","visible","singleton","multiple","ignoreAttributes","__source","__self","restOfNativeProps","isControlledMode","undefined","isSingletonMode","useState","mounted","setMounted","container","trigger","type","tippy","show","hide","cloneElement","createPortal","process","env","NODE_ENV","ContentType","PropTypes","oneOfType","number","string","element","propTypes","arrayOf","isRequired","bool","func","forwardRef","TippyWrapper","TippySingleton","length","Children","map","child","onCreate","push","useSingleton"],"mappings":"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"}
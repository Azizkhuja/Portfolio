{"version":3,"file":"tippy-react.umd.min.js","sources":["../src/utils.js","../src/util-hooks.js","../src/Tippy.js","../src/TippySingleton.js","../src/hooks.js"],"sourcesContent":["export const isBrowser =\n  typeof window !== 'undefined' && typeof document !== 'undefined';\n\nexport function preserveRef(ref, node) {\n  if (ref) {\n    if (typeof ref === 'function') {\n      ref(node);\n    }\n    if ({}.hasOwnProperty.call(ref, 'current')) {\n      ref.current = node;\n    }\n  }\n}\n\nexport function ssrSafeCreateDiv() {\n  return isBrowser && document.createElement('div');\n}\n\nexport function updateClassName(tooltip, action, classNames) {\n  classNames.split(/\\s+/).forEach(name => {\n    if (name) {\n      tooltip.classList[action](name);\n    }\n  });\n}\n","import {isBrowser, updateClassName} from './utils';\nimport {useLayoutEffect, useEffect, useRef} from 'react';\nimport {createSingleton} from 'tippy.js';\n\nexport const useIsomorphicLayoutEffect = isBrowser\n  ? useLayoutEffect\n  : useEffect;\n\nexport function useUpdateClassName(component, className, deps) {\n  useIsomorphicLayoutEffect(() => {\n    const {tooltip} = component.instance.popperChildren;\n    if (className) {\n      updateClassName(tooltip, 'add', className);\n      return () => {\n        updateClassName(tooltip, 'remove', className);\n      };\n    }\n  }, [className, ...deps]);\n}\n\nexport function useInstance(initialValue) {\n  // Using refs instead of state as it's recommended to not store imperative\n  // values in state due to memory problems in React(?)\n  const ref = useRef();\n\n  if (!ref.current) {\n    ref.current =\n      typeof initialValue === 'function' ? initialValue() : initialValue;\n  }\n\n  return ref.current;\n}\n\nexport function useSingletonCreate(component, props, enabled, deps) {\n  useIsomorphicLayoutEffect(() => {\n    const {instances} = component;\n    const instance = createSingleton(instances, props);\n\n    component.instance = instance;\n\n    if (!enabled) {\n      instance.disable();\n    }\n\n    return () => {\n      instance.destroy();\n      component.instances = instances.filter(i => !i.state.isDestroyed);\n    };\n  }, deps);\n}\n\nexport function useSingletonUpdate(component, props, enabled) {\n  useIsomorphicLayoutEffect(() => {\n    if (component.renders === 1) {\n      component.renders++;\n      return;\n    }\n\n    const {instance} = component;\n\n    instance.setProps(props);\n\n    if (enabled) {\n      instance.enable();\n    } else {\n      instance.disable();\n    }\n  });\n}\n","import React, {forwardRef, cloneElement, useState} from 'react';\nimport PropTypes from 'prop-types';\nimport {createPortal} from 'react-dom';\nimport tippy from 'tippy.js';\nimport {preserveRef, ssrSafeCreateDiv} from './utils';\nimport {\n  useInstance,\n  useIsomorphicLayoutEffect,\n  useUpdateClassName,\n} from './util-hooks';\n\nexport function Tippy({\n  children,\n  content,\n  className,\n  visible,\n  singleton,\n  enabled = true,\n  multiple = true,\n  ignoreAttributes = true,\n  // Filter React development reserved props\n  // added by babel-preset-react dev plugins:\n  // transform-react-jsx-self and transform-react-jsx-source\n  __source,\n  __self,\n  ...restOfNativeProps\n}) {\n  const isControlledMode = visible !== undefined;\n  const isSingletonMode = singleton !== undefined;\n\n  const [mounted, setMounted] = useState(false);\n  const component = useInstance(() => ({\n    container: ssrSafeCreateDiv(),\n    renders: 1,\n  }));\n\n  const props = {\n    ignoreAttributes,\n    multiple,\n    ...restOfNativeProps,\n    content: component.container,\n  };\n\n  if (isControlledMode) {\n    props.trigger = 'manual';\n  }\n\n  if (isSingletonMode) {\n    enabled = false;\n  }\n\n  const deps = [children.type];\n\n  // CREATE\n  useIsomorphicLayoutEffect(() => {\n    const instance = tippy(component.ref, props);\n\n    component.instance = instance;\n\n    if (!enabled) {\n      instance.disable();\n    }\n\n    if (visible) {\n      instance.show();\n    }\n\n    if (isSingletonMode) {\n      singleton(instance);\n    }\n\n    setMounted(true);\n\n    return () => {\n      instance.destroy();\n    };\n  }, deps);\n\n  // UPDATE\n  useIsomorphicLayoutEffect(() => {\n    // Prevent this effect from running on 1st render\n    if (component.renders === 1) {\n      component.renders++;\n      return;\n    }\n\n    const {instance} = component;\n\n    instance.setProps(props);\n\n    if (enabled) {\n      instance.enable();\n    } else {\n      instance.disable();\n    }\n\n    if (isControlledMode) {\n      if (visible) {\n        instance.show();\n      } else {\n        instance.hide();\n      }\n    }\n  });\n\n  useUpdateClassName(component, className, deps);\n\n  return (\n    <>\n      {cloneElement(children, {\n        ref(node) {\n          component.ref = node;\n          preserveRef(children.ref, node);\n        },\n      })}\n      {mounted && createPortal(content, component.container)}\n    </>\n  );\n}\n\nif (process.env.NODE_ENV !== 'production') {\n  const ContentType = PropTypes.oneOfType([\n    PropTypes.number,\n    PropTypes.string,\n    PropTypes.element,\n  ]);\n\n  Tippy.propTypes = {\n    content: PropTypes.oneOfType([ContentType, PropTypes.arrayOf(ContentType)])\n      .isRequired,\n    children: PropTypes.element.isRequired,\n    visible: PropTypes.bool,\n    enabled: PropTypes.bool,\n    className: PropTypes.string,\n    singleton: PropTypes.func,\n  };\n}\n\nexport default forwardRef(function TippyWrapper({children, ...props}, ref) {\n  return (\n    <Tippy {...props}>\n      {cloneElement(children, {\n        ref(node) {\n          preserveRef(ref, node);\n          preserveRef(children.ref, node);\n        },\n      })}\n    </Tippy>\n  );\n});\n","import {Children, cloneElement} from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  useInstance,\n  useUpdateClassName,\n  useSingletonUpdate,\n  useSingletonCreate,\n} from './util-hooks';\n\nexport default function TippySingleton({\n  children,\n  className,\n  enabled = true,\n  ignoreAttributes = true,\n  ...restOfNativeProps\n}) {\n  const component = useInstance({\n    instances: [],\n    renders: 1,\n  });\n\n  const props = {\n    ignoreAttributes,\n    ...restOfNativeProps,\n  };\n\n  const deps = [children.length];\n\n  useSingletonCreate(component, props, enabled, deps);\n  useSingletonUpdate(component, props, enabled);\n  useUpdateClassName(component, className, deps);\n\n  return Children.map(children, child => {\n    return cloneElement(child, {\n      enabled: false,\n      onCreate(instance) {\n        if (child.props.onCreate) {\n          child.props.onCreate(instance);\n        }\n\n        component.instances.push(instance);\n      },\n    });\n  });\n}\n\nif (process.env.NODE_ENV !== 'production') {\n  TippySingleton.propTypes = {\n    children: PropTypes.arrayOf(PropTypes.element).isRequired,\n  };\n}\n","import {\n  useInstance,\n  useSingletonCreate,\n  useSingletonUpdate,\n  useUpdateClassName,\n} from './util-hooks';\n\nexport function useSingleton({\n  className,\n  enabled = true,\n  ignoreAttributes = true,\n  ...restOfNativeProps\n} = {}) {\n  const component = useInstance({\n    instance: null,\n    instances: [],\n    renders: 1,\n  });\n\n  const props = {\n    ignoreAttributes,\n    ...restOfNativeProps,\n  };\n\n  const deps = [component.instances.length];\n\n  useSingletonCreate(component, props, enabled, deps);\n  useSingletonUpdate(component, props, enabled);\n  useUpdateClassName(component, className, deps);\n\n  return instance => {\n    component.instances.push(instance);\n  };\n}\n"],"names":["isBrowser","window","document","preserveRef","ref","node","hasOwnProperty","call","current","updateClassName","tooltip","action","classNames","split","forEach","name","classList","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","useUpdateClassName","component","className","deps","instance","popperChildren","useInstance","initialValue","useRef","useSingletonCreate","props","enabled","instances","createSingleton","disable","destroy","filter","i","state","isDestroyed","useSingletonUpdate","renders","setProps","enable","Tippy","children","content","visible","singleton","multiple","ignoreAttributes","restOfNativeProps","__source","__self","isControlledMode","undefined","isSingletonMode","useState","mounted","setMounted","container","createElement","trigger","type","tippy","show","hide","React","cloneElement","createPortal","forwardRef","length","Children","map","child","onCreate","push"],"mappings":"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"}